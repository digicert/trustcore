/* p256 = 2^256 - 2^224 + 2^192 + 2^96 - 1 */

/*
 EVP style tests of encryption and decryption
 of one or two or four blocks will use the following
 arrays respectively. Each 4 x 4 matrix you see consists
 of a single test.
 
 The first row indicates the indices of plainText that
 will be fed into ECEG_update when encrypting. The indices
 we expect to see for the the output cipherText are the
 second row. Remember ECEG_update will only give output
 once a full block of input has been given.
 
 The third row indicates the indices of cipherText that
 will be fed into ECEG_update when decrypting. The indices
 we expect to see for the the output plainText are the
 fourth row.
 
 We make at most 3 calls to ECEG_update so the last value
 in each row is the total length of the plaintext or
 ciphertext respectively.
 */
static ubyte4 gpIndicesOneBlock_p256[][4][4] =
{
    {  /* one update call */
        {0,0,0,28},
        {0,0,0,128},
        {0,0,0,128},
        {0,0,0,32}
    },
    {  /* two update calls */
        {0,0,1,28},
        {0,0,0,128},
        {0,0,1,128},
        {0,0,0,32}
    },
    {
        {0,0,27,28},
        {0,0,0,128},
        {0,0,127,128},
        {0,0,0,32}
    },
    {  /* three update calls */
        {0,1,27,28},
        {0,0,0,128},
        {0,1,127,128},
        {0,0,0,32}
    },
    {
        {0,8,20,28},
        {0,0,0,128},
        {0,56,84,128},
        {0,0,0,32}
    }
};

static ubyte4 gpIndicesTwoBlocks_p256[][4][4] =
{
    {  /* one update call */
        {0,0,0,56},
        {0,0,0,256},
        {0,0,0,256},
        {0,0,0,64}
    },
    {  /* two update calls */
        {0,0,27,56},
        {0,0,0,256},
        {0,0,127,256},
        {0,0,0,64}
    },
    {
        {0,0,55,56},
        {0,0,128,256},
        {0,0,255,256},
        {0,0,32,64}
    },
    {  /* three update calls */
        {0,27,28,56},
        {0,0,128,256},
        {0,127,128,256},
        {0,0,32,64}
    },
    {
        {0,29,55,56},
        {0,128,128,256},
        {0,129,255,256},
        {0,32,32,64}
    }
};

static ubyte4 gpIndicesFourBlocks_p256[][4][4] =
{
    {  /* one update call */
        {0,0,0,112},
        {0,0,0,512},
        {0,0,0,512},
        {0,0,0,128}
    },
    {  /* two update calls */
        {0,0,27,112},
        {0,0,0,512},
        {0,0,511,512},
        {0,0,96,128}
    },
    {
        {0,0,28,112},
        {0,0,128,512},
        {0,0,128,512},
        {0,0,32,128}
    },
    {
        {0,0,29,112},
        {0,0,128,512},
        {0,0,129,512},
        {0,0,32,128}
    },
    {
        {0,0,56,112},
        {0,0,256,512},
        {0,0,256,512},
        {0,0,64,128}
    },
    {
        {0,0,111,112},
        {0,0,384,512},
        {0,0,511,512},
        {0,0,96,128}
    },
    {  /* three update calls */
        {0,27,28,112},
        {0,0,128,512},
        {0,127,128,512},
        {0,0,32,128}
    },
    {
        {0,27,57,112},
        {0,0,256,512},
        {0,127,257,512},
        {0,0,64,128}
    },
    {
        {0,27,111,112},
        {0,0,384,512},
        {0,127,511,512},
        {0,0,96,128}
    },
    {
        {0,29,55,112},
        {0,128,128,512},
        {0,128,255,512},
        {0,32,32,128}
    },
    {
        {0,29,57,112},
        {0,128,256,512},
        {0,128,257,512},
        {0,32,64,128}
    },
    {
        {0,29,111,112},
        {0,128,384,512},
        {0,129,511,512},
        {0,32,96,128}
    },
    {
        {0,57,59,112},
        {0,256,256,512},
        {0,257,383,512},
        {0,64,64,128}
    },
    {
        {0,57,111,112},
        {0,256,384,512},
        {0,257,511,512},
        {0,64,96,128}
    }
};


/*
 Test Vectors.
 
 {
 char *pPrivateKey;  32 bytes
 char *pPublicKey;   0x04 and then concatenated x and y coords, 65 bytes total
 char *pNonce;       32 byte blocks
 char *pPlainText;   28 byte blocks
 char *pCipherText;  128 byte blocks
 ubyte numBlocks     Quick reference for the number of blocks of plain/ciphertext
                     in the test vector
 }
 
 Input vectors are generated randomly. The resulting pCipherText is
 computed with MAGMA. We test only up to 4 blocks as that is enough data to
 cover all edge cases. Edge cases related to the private and public keys are
 covered in other ecc tests, so one value of each here should be sufficient.
 Also note nonce must be non-zero. We do test plaintext all 0x00
 (even though that isn't really an edge case anyway).
 
 More test vectors could be added if necessary.
 */
static TestVector gTestVector_p256[] =
{
    {
        "DB9EF4DB4C30FE776EBFC4BEC9D9C3E0EB72EC9A3EA4ECCB11EF3CB48411509F",
        "047E2B921937EBD347E8340EFA0C5E6300C2209FBB30559DD15D87A5A81E87A9EE3EA5B7131BDA798E6BC8CD011F654EDA5BC7233E817E9844314C40165F0464D2",
        "6281A12F63367FE1F733CCD888C7E7F9DB81D78866A3500A2BF82B1B096050FF",
        "ED01225651628783C373B84F1A1696B355C0E9DA83066BF4B2687911",
        "E0568166D750CF5964D2CEC57BB49F3C4EFBDA61311DF8C06DCA9E7D3509BAA1D3FCA452A7A2B7A983640B75A74FDE62549B30F174FC79712628695E8280EF0D"
        "4E812C925BB663E1E10E30AA1662DBBBE6BB5AAB0A04B1673FD0D5771BB0B712A578748E265BE632D1C9B6029EDC8CA5A3102AD5201AF66999E08445AC079FED",
        1
    },
    {
        "DB9EF4DB4C30FE776EBFC4BEC9D9C3E0EB72EC9A3EA4ECCB11EF3CB48411509F",
        "047E2B921937EBD347E8340EFA0C5E6300C2209FBB30559DD15D87A5A81E87A9EE3EA5B7131BDA798E6BC8CD011F654EDA5BC7233E817E9844314C40165F0464D2",
        "77FB0136BAC1E5C8E1FB7293D5598C75915116DD7DF632975E5107EE33F601F1",
        "03C28EB686142F41A882EDB6FAD40AEBAD1ACDBE7C4C43D88B64FC69",
        "089EA872292818AF0BB66C64466C08C07F370C73C8B2F20CB6BB8C76B605E10D2036207D136AD7BF0ED8CE614DE538AF9592CC561C0680F71C1CEC510B1D2D0F"
        "C4CEFA4B2BAEC805E2E3906FF0C79C9B384560454EF77E4C3275DFA2D8DBFA0923B9CD3068CE36E55E78255BD60FF24C01849483F36F2B483101BD6715D85FA4",
        1
    },
    {
        "DB9EF4DB4C30FE776EBFC4BEC9D9C3E0EB72EC9A3EA4ECCB11EF3CB48411509F",
        "047E2B921937EBD347E8340EFA0C5E6300C2209FBB30559DD15D87A5A81E87A9EE3EA5B7131BDA798E6BC8CD011F654EDA5BC7233E817E9844314C40165F0464D2",
        "93C54680B687E213E8D709616BCC614294FE2087E0B6B503A9263910FA59D213",
        "76C7C703F5639FD10DCC6E5BCA627E1419EB18D1EBACC8A4AC112687",
        "E312CEF15E2AF76DE9D5A21DDE945CD17260F80E5372F78B117B11C3F033F44C80E015CD09B196CF617FEA274C864000BCEC9ED51272C12206874B3B7D806D73"
        "37F457B2CDCF2960954C334F24033E54A69C2BE8EFCA8203D8A0969603E16FDE267C05FA4DD35234E2A30168EDCFB8504450B74CAB999EA9E7C72B7F23477B03",
        1
    },
    {
        "DB9EF4DB4C30FE776EBFC4BEC9D9C3E0EB72EC9A3EA4ECCB11EF3CB48411509F",
        "047E2B921937EBD347E8340EFA0C5E6300C2209FBB30559DD15D87A5A81E87A9EE3EA5B7131BDA798E6BC8CD011F654EDA5BC7233E817E9844314C40165F0464D2",
        "B06DF1A78F1D6E57F0EF08C1C8800A7187ABEF8BA83108775A2D766CAAA39197",
        "FFFB204C9A51078578716109A7FC7B5BF23F36AD57003CBEC5A0FDD1",
        "E34D241FF00233EB852910DFD1DB7DEB1E74FEE8D9F39B56159BAE623EE39B14BFDAB0E46167BFE78164D021C9DD4A86167A1E8BA6EA9E5B3FA88880085A8B75"
        "4F5D9A395CAE4A12E63566AD4EC939C2CBE820F35F7E86BFEA62FC4FBEB426634AE53377B32A10B8832FEFF6BD91785E37272085385501649E31F64B9D57985F",
        1
    },
    {
        "DB9EF4DB4C30FE776EBFC4BEC9D9C3E0EB72EC9A3EA4ECCB11EF3CB48411509F",
        "047E2B921937EBD347E8340EFA0C5E6300C2209FBB30559DD15D87A5A81E87A9EE3EA5B7131BDA798E6BC8CD011F654EDA5BC7233E817E9844314C40165F0464D2",
        "F263C1651C467C6B3F7ADB3D2CE7A9C6269C256510517A7B597C2ED33E532EF3",
        "80FA3BDD6C8135DC1FB2DBE174ED4B9F945517A4480D7C641E58D15D",
        "47ED6A8E24EC46ABE7F0F12017D345D0D9395E1FDC7A6C96E720852DBC361C2C47B2F1F5128824EB74CCA5B32A04DECD2EEFC996A086B3D7CCBAB47272A9D9D4"
        "287E9B4BCDC52584DAAA38A61619052564E7509E53C2BB83DAD744DBEC1EA74ECB10C71601F91DD0A8D53A05127C39270C598239119F659FDBFF5119B2B448C7",
        1
    },
    {   /* zero plaintext */
        "DB9EF4DB4C30FE776EBFC4BEC9D9C3E0EB72EC9A3EA4ECCB11EF3CB48411509F",
        "047E2B921937EBD347E8340EFA0C5E6300C2209FBB30559DD15D87A5A81E87A9EE3EA5B7131BDA798E6BC8CD011F654EDA5BC7233E817E9844314C40165F0464D2",
        "F263C1651C467C6B3F7ADB3D2CE7A9C6269C256510517A7B597C2ED33E532EF3",
        "00000000000000000000000000000000000000000000000000000000",
        "47ED6A8E24EC46ABE7F0F12017D345D0D9395E1FDC7A6C96E720852DBC361C2C47B2F1F5128824EB74CCA5B32A04DECD2EEFC996A086B3D7CCBAB47272A9D9D4"
        "2691893C850F8E5DC3A1CA0B5955D511550DEB4510452FFEA643EBD7303D1E09E5E290518130CB3C458C523A3556145877CA6D9853DA58BC31D3030937CA6600",
        1
    },
    {   /* zero plaintext for multiple blocks */
        "DB9EF4DB4C30FE776EBFC4BEC9D9C3E0EB72EC9A3EA4ECCB11EF3CB48411509F",
        "047E2B921937EBD347E8340EFA0C5E6300C2209FBB30559DD15D87A5A81E87A9EE3EA5B7131BDA798E6BC8CD011F654EDA5BC7233E817E9844314C40165F0464D2",
        "F263C1651C467C6B3F7ADB3D2CE7A9C6269C256510517A7B597C2ED33E532EF3"
        "B06DF1A78F1D6E57F0EF08C1C8800A7187ABEF8BA83108775A2D766CAAA39197",
        "00000000000000000000000000000000000000000000000000000000"
        "00000000000000000000000000000000000000000000000000000000",
        "47ED6A8E24EC46ABE7F0F12017D345D0D9395E1FDC7A6C96E720852DBC361C2C47B2F1F5128824EB74CCA5B32A04DECD2EEFC996A086B3D7CCBAB47272A9D9D4"
        "2691893C850F8E5DC3A1CA0B5955D511550DEB4510452FFEA643EBD7303D1E09E5E290518130CB3C458C523A3556145877CA6D9853DA58BC31D3030937CA6600"
        "E34D241FF00233EB852910DFD1DB7DEB1E74FEE8D9F39B56159BAE623EE39B14BFDAB0E46167BFE78164D021C9DD4A86167A1E8BA6EA9E5B3FA88880085A8B75"
        "34A06D049F88E1EECB34F0D222BC4CED4F9DAE61C9A8C19923CB44031E5A595242D3A99FAB8BDA6D4DEE6E8A35C681CD093A7C6D5B4643CED829B007ABE222FD",
        2
    },
    {
        "DB9EF4DB4C30FE776EBFC4BEC9D9C3E0EB72EC9A3EA4ECCB11EF3CB48411509F",
        "047E2B921937EBD347E8340EFA0C5E6300C2209FBB30559DD15D87A5A81E87A9EE3EA5B7131BDA798E6BC8CD011F654EDA5BC7233E817E9844314C40165F0464D2",
        "6281A12F63367FE1F733CCD888C7E7F9DB81D78866A3500A2BF82B1B096050FF"
        "77FB0136BAC1E5C8E1FB7293D5598C75915116DD7DF632975E5107EE33F601F1",
        "ED01225651628783C373B84F1A1696B355C0E9DA83066BF4B2687911"
        "03C28EB686142F41A882EDB6FAD40AEBAD1ACDBE7C4C43D88B64FC69",
        "E0568166D750CF5964D2CEC57BB49F3C4EFBDA61311DF8C06DCA9E7D3509BAA1D3FCA452A7A2B7A983640B75A74FDE62549B30F174FC79712628695E8280EF0D"
        "4E812C925BB663E1E10E30AA1662DBBBE6BB5AAB0A04B1673FD0D5771BB0B712A578748E265BE632D1C9B6029EDC8CA5A3102AD5201AF66999E08445AC079FED"
        "089EA872292818AF0BB66C64466C08C07F370C73C8B2F20CB6BB8C76B605E10D2036207D136AD7BF0ED8CE614DE538AF9592CC561C0680F71C1CEC510B1D2D0F"
        "C4CEFA4B2BAEC805E2E3906FF0C79C9B384560454EF77E4C3275DFA2D8DBFA0923B9CD3068CE36E55E78255BD60FF24C01849483F36F2B483101BD6715D85FA4",
        2
    },
    {
        "DB9EF4DB4C30FE776EBFC4BEC9D9C3E0EB72EC9A3EA4ECCB11EF3CB48411509F",
        "047E2B921937EBD347E8340EFA0C5E6300C2209FBB30559DD15D87A5A81E87A9EE3EA5B7131BDA798E6BC8CD011F654EDA5BC7233E817E9844314C40165F0464D2",
        "93C54680B687E213E8D709616BCC614294FE2087E0B6B503A9263910FA59D213"
        "B06DF1A78F1D6E57F0EF08C1C8800A7187ABEF8BA83108775A2D766CAAA39197",
        "76C7C703F5639FD10DCC6E5BCA627E1419EB18D1EBACC8A4AC112687"
        "FFFB204C9A51078578716109A7FC7B5BF23F36AD57003CBEC5A0FDD1",
        "E312CEF15E2AF76DE9D5A21DDE945CD17260F80E5372F78B117B11C3F033F44C80E015CD09B196CF617FEA274C864000BCEC9ED51272C12206874B3B7D806D73"
        "37F457B2CDCF2960954C334F24033E54A69C2BE8EFCA8203D8A0969603E16FDE267C05FA4DD35234E2A30168EDCFB8504450B74CAB999EA9E7C72B7F23477B03"
        "E34D241FF00233EB852910DFD1DB7DEB1E74FEE8D9F39B56159BAE623EE39B14BFDAB0E46167BFE78164D021C9DD4A86167A1E8BA6EA9E5B3FA88880085A8B75"
        "4F5D9A395CAE4A12E63566AD4EC939C2CBE820F35F7E86BFEA62FC4FBEB426634AE53377B32A10B8832FEFF6BD91785E37272085385501649E31F64B9D57985F",
        2
    },
    {
        "DB9EF4DB4C30FE776EBFC4BEC9D9C3E0EB72EC9A3EA4ECCB11EF3CB48411509F",
        "047E2B921937EBD347E8340EFA0C5E6300C2209FBB30559DD15D87A5A81E87A9EE3EA5B7131BDA798E6BC8CD011F654EDA5BC7233E817E9844314C40165F0464D2",
        "6281A12F63367FE1F733CCD888C7E7F9DB81D78866A3500A2BF82B1B096050FF"
        "77FB0136BAC1E5C8E1FB7293D5598C75915116DD7DF632975E5107EE33F601F1"
        "93C54680B687E213E8D709616BCC614294FE2087E0B6B503A9263910FA59D213"
        "B06DF1A78F1D6E57F0EF08C1C8800A7187ABEF8BA83108775A2D766CAAA39197",
        "ED01225651628783C373B84F1A1696B355C0E9DA83066BF4B2687911"
        "03C28EB686142F41A882EDB6FAD40AEBAD1ACDBE7C4C43D88B64FC69"
        "76C7C703F5639FD10DCC6E5BCA627E1419EB18D1EBACC8A4AC112687"
        "FFFB204C9A51078578716109A7FC7B5BF23F36AD57003CBEC5A0FDD1",
        "E0568166D750CF5964D2CEC57BB49F3C4EFBDA61311DF8C06DCA9E7D3509BAA1D3FCA452A7A2B7A983640B75A74FDE62549B30F174FC79712628695E8280EF0D"
        "4E812C925BB663E1E10E30AA1662DBBBE6BB5AAB0A04B1673FD0D5771BB0B712A578748E265BE632D1C9B6029EDC8CA5A3102AD5201AF66999E08445AC079FED"
        "089EA872292818AF0BB66C64466C08C07F370C73C8B2F20CB6BB8C76B605E10D2036207D136AD7BF0ED8CE614DE538AF9592CC561C0680F71C1CEC510B1D2D0F"
        "C4CEFA4B2BAEC805E2E3906FF0C79C9B384560454EF77E4C3275DFA2D8DBFA0923B9CD3068CE36E55E78255BD60FF24C01849483F36F2B483101BD6715D85FA4"
        "E312CEF15E2AF76DE9D5A21DDE945CD17260F80E5372F78B117B11C3F033F44C80E015CD09B196CF617FEA274C864000BCEC9ED51272C12206874B3B7D806D73"
        "37F457B2CDCF2960954C334F24033E54A69C2BE8EFCA8203D8A0969603E16FDE267C05FA4DD35234E2A30168EDCFB8504450B74CAB999EA9E7C72B7F23477B03"
        "E34D241FF00233EB852910DFD1DB7DEB1E74FEE8D9F39B56159BAE623EE39B14BFDAB0E46167BFE78164D021C9DD4A86167A1E8BA6EA9E5B3FA88880085A8B75"
        "4F5D9A395CAE4A12E63566AD4EC939C2CBE820F35F7E86BFEA62FC4FBEB426634AE53377B32A10B8832FEFF6BD91785E37272085385501649E31F64B9D57985F",
        4
    }
};

/*
 typedef struct TestVectorPKCS
 {
 char *pPrivateKey;
 char *pPublicKey;
 char *pNonce;
 char *pPlainText;
 char *pCipherText;
 
 } TestVectorPKCS;
 
 Input vectors are generated randomly. The resulting pCipherText is
 computed with MAGMA.
 */
static TestVectorPKCS gTestVector_p256PKCS[] =
{
    {   /* 16 byte message */
        "E1B6745A4DB15A83852600D0B00E6ADE78DCF92418A75928A06EE01FBE905ED4",
        "0418592020FD2BCE89CE8A7617ECCFD4DD7AB3C8DFEADCC337E35226CB7CBC5F2E0F8E02C492EECB92ED0DBF7B6D84999CC6E6194CA29EB1E41DBB1EC6ABFFB843",
        "19A55FA344B36455C9"
        "D18CDF18BDF98A1B4CE2CC40DE7CA65572886849B0A27A41415F8DEDC2CF026E",
        "A18B16BCF42B1ED239028B16BCA1D68B",
        "3CBFEA568D0A7C560B4BE065AC0ABB2D3E6045EF16E4F40291765EF3C52953B7987DF4264CF02464ED91646FE972397D248ECA7CA87E90B67248F62B4BB9163C"
        "96BD5B0AE1132E96CBA9D61430BFE6D530BBCF0C98686C8C2E03FEFF975F5CBFF38F8CB7A69251C9BE9089B8253144BB06C3816479BB64C5DF0A500040D82CF6"
    },
    {   /* 17 byte message (largest possible) */
        "E1B6745A4DB15A83852600D0B00E6ADE78DCF92418A75928A06EE01FBE905ED4",
        "0418592020FD2BCE89CE8A7617ECCFD4DD7AB3C8DFEADCC337E35226CB7CBC5F2E0F8E02C492EECB92ED0DBF7B6D84999CC6E6194CA29EB1E41DBB1EC6ABFFB843",
        "19A55FA344B36455"
        "D18CDF18BDF98A1B4CE2CC40DE7CA65572886849B0A27A41415F8DEDC2CF026E",
        "00A18B16BCF42B1ED239028B16BCA1D68B",
        "3CBFEA568D0A7C560B4BE065AC0ABB2D3E6045EF16E4F40291765EF3C52953B7987DF4264CF02464ED91646FE972397D248ECA7CA87E90B67248F62B4BB9163C"
        "696ED53A60027FDEF181FC1A8397586C4710B6BAC4A8BF487C38E282AC2E97C11EB6147B1A104043C175588D73C2600B53F97CAB2E8C58E79DA423F845058873"
    },
    {   /* 1 byte message (smallest possible) */
        "E1B6745A4DB15A83852600D0B00E6ADE78DCF92418A75928A06EE01FBE905ED4",
        "0418592020FD2BCE89CE8A7617ECCFD4DD7AB3C8DFEADCC337E35226CB7CBC5F2E0F8E02C492EECB92ED0DBF7B6D84999CC6E6194CA29EB1E41DBB1EC6ABFFB843",
        "19A55FA344B3645519A55FA344B3645519A55FA344B36455"
        "D18CDF18BDF98A1B4CE2CC40DE7CA65572886849B0A27A41415F8DEDC2CF026E",
        "00",
        "3CBFEA568D0A7C560B4BE065AC0ABB2D3E6045EF16E4F40291765EF3C52953B7987DF4264CF02464ED91646FE972397D248ECA7CA87E90B67248F62B4BB9163C"
        "3A21A8E04B4E99AE4AD589214AFF81A081C12194A7F173BC7A0E4899246F2AD72B6322548561372C47DC7DB5FBDDE3C37AB0A787D002EC75D442E426C5271424"
    }
};
