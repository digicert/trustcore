/* p224 = 2^224 - 2^96 + 1 */

/*
 EVP style tests of encryption and decryption
 of one or two or four blocks will use the following
 arrays respectively. Each 4 x 4 matrix you see consists
 of a single test.
 
 The first row indicates the indices of plainText that
 will be fed into ECEG_update when encrypting. The indices
 we expect to see for the the output cipherText are the
 second row. Remember ECEG_update will only give output
 once a full block of input has been given.
 
 The third row indicates the indices of cipherText that
 will be fed into ECEG_update when decrypting. The indices
 we expect to see for the the output plainText are the
 fourth row.
 
 We make at most 3 calls to ECEG_update so the last value
 in each row is the total length of the plaintext or
 ciphertext respectively.
 */
static ubyte4 gpIndicesOneBlock_p224[][4][4] =
{
    {  /* one update call */
        {0,0,0,24},
        {0,0,0,112},
        {0,0,0,112},
        {0,0,0,28}
    },
    {  /* two update calls */
        {0,0,1,24},
        {0,0,0,112},
        {0,0,1,112},
        {0,0,0,28}
    },
    {
        {0,0,23,24},
        {0,0,0,112},
        {0,0,111,112},
        {0,0,0,28}
    },
    {  /* three update calls */
        {0,1,23,24},
        {0,0,0,112},
        {0,1,111,112},
        {0,0,0,28}
    },
    {
        {0,8,16,24},
        {0,0,0,112},
        {0,56,84,112},
        {0,0,0,28}
    }
};

static ubyte4 gpIndicesTwoBlocks_p224[][4][4] =
{
    {  /* one update call */
        {0,0,0,48},
        {0,0,0,224},
        {0,0,0,224},
        {0,0,0,56}
    },
    {  /* two update calls */
        {0,0,23,48},
        {0,0,0,224},
        {0,0,111,224},
        {0,0,0,56}
    },
    {
        {0,0,47,48},
        {0,0,112,224},
        {0,0,223,224},
        {0,0,28,56}
    },
    {  /* three update calls */
        {0,23,24,48},
        {0,0,112,224},
        {0,111,112,224},
        {0,0,28,56}
    },
    {
        {0,25,47,48},
        {0,112,112,224},
        {0,113,223,224},
        {0,28,28,56}
    }
};

static ubyte4 gpIndicesFourBlocks_p224[][4][4] =
{
    {  /* one update call */
        {0,0,0,96},
        {0,0,0,448},
        {0,0,0,448},
        {0,0,0,112}
    },
    {  /* two update calls */
        {0,0,23,96},
        {0,0,0,448},
        {0,0,111,448},
        {0,0,0,112}
    },
    {
        {0,0,24,96},
        {0,0,112,448},
        {0,0,112,448},
        {0,0,28,112}
    },
    {
        {0,0,25,96},
        {0,0,112,448},
        {0,0,113,448},
        {0,0,28,112}
    },
    {
        {0,0,48,96},
        {0,0,224,448},
        {0,0,224,448},
        {0,0,56,112}
    },
    {
        {0,0,95,96},
        {0,0,336,448},
        {0,0,447,448},
        {0,0,84,112}
    },
    {  /* three update calls */
        {0,23,24,96},
        {0,0,112,448},
        {0,111,112,448},
        {0,0,28,112}
    },
    {
        {0,23,49,96},
        {0,0,224,448},
        {0,111,225,448},
        {0,0,56,112}
    },
    {
        {0,23,95,96},
        {0,0,336,448},
        {0,111,447,448},
        {0,0,84,112}
    },
    {
        {0,25,47,96},
        {0,112,112,448},
        {0,113,223,448},
        {0,28,28,112}
    },
    {
        {0,25,49,96},
        {0,112,224,448},
        {0,113,225,448},
        {0,28,56,112}
    },
    {
        {0,25,95,96},
        {0,112,336,448},
        {0,113,447,448},
        {0,28,84,112}
    },
    {
        {0,49,71,96},
        {0,224,224,448},
        {0,225,335,448},
        {0,56,56,112}
    },
    {
        {0,49,95,96},
        {0,224,336,448},
        {0,225,447,448},
        {0,56,84,112}
    }
};


/*
 Test Vectors.
 
 {
 char *pPrivateKey;  28 bytes
 char *pPublicKey;   0x04 and then concatenated x and y coords, 57 bytes total
 char *pNonce;       32 byte blocks (rounded up to a multiple of a pf_unit)
 char *pPlainText;   24 byte blocks
 char *pCipherText;  112 byte blocks
 ubyte numBlocks     Quick reference for the number of blocks of plain/ciphertext
                     in the test vector
 }
 
 Input vectors are generated randomly. The resulting pCipherText is
 computed with MAGMA. We test only up to 4 blocks as that is enough data to
 cover all edge cases. Edge cases related to the private and public keys are
 covered in other ecc tests, so one value of each here should be sufficient.
 Also note nonce must be non-zero. We do test plaintext all 0x00
 (even though that isn't really an edge case anyway).
 
 More test vectors could be added if necessary.
 */
static TestVector gTestVector_p224[] =
{
    {
        "AD5FAF1662FFB610E47A3AD6AC510DCB838F31C3EE754F2149192E11",
        "040A4065BE26C0DCEEF7E45A6EFEB5377D97242E6A76003940223E9DECB0A111C6CC785039AC335D79176E23B4E3D98F2845644A3E1FB7B840",
#ifdef __ENABLE_DIGICERT_64_BIT__
        "000000000FADF40B3B70EF3FD9FB9A2B41F88D1B7CC97E03FEB88A5B6F701E77",
#else
        "0FADF40B3B70EF3FD9FB9A2B41F88D1B7CC97E03FEB88A5B6F701E77",
#endif
        "FAEFBD67893CAD4720EF6CD5DAD3CDD2C5FEA55E865303A6",
        "00A0D8620FEE600486090182600462BF3825D1ED9B41BCE1428E718C405D32942814A747B1B961974438BC6AF9D8000A80CB52CF13CFFFCF"
        "2C12B894B38A2C9370C2F922932BB6ED645ADF48B274889519C6110EF0BAC4C41F69697CB70DD4659E8FF8F54C257C2A7D7BA5C2ED082656",
        1
    },
    {
        "AD5FAF1662FFB610E47A3AD6AC510DCB838F31C3EE754F2149192E11",
        "040A4065BE26C0DCEEF7E45A6EFEB5377D97242E6A76003940223E9DECB0A111C6CC785039AC335D79176E23B4E3D98F2845644A3E1FB7B840",
#ifdef __ENABLE_DIGICERT_64_BIT__
        "000000008B4AFBEC34D9CAB6C93B4A686DE57B049776E33D0DA39D3078AF4E19",
#else
        "8B4AFBEC34D9CAB6C93B4A686DE57B049776E33D0DA39D3078AF4E19",
#endif
        "C04865365C91E805CB7C057922AC8D26D443A3C20BD29D0B",
        "2CF4224DCDFC98868960B131A5AEE26E73B89CF428B56FFDD2B8D746145AF087CAB636CEB1F40353029C2EEEDE586943539C8E81FA45FE59"
        "0BC69B8ACE1AB88A4C2BBE04A28CAD539CC1C67BB82FB1FF538561869AF67EA9B33B8258F6A9CE61D62A713E967E5B8F08E31515C3C9E48E",
        1
    },
    {
        "AD5FAF1662FFB610E47A3AD6AC510DCB838F31C3EE754F2149192E11",
        "040A4065BE26C0DCEEF7E45A6EFEB5377D97242E6A76003940223E9DECB0A111C6CC785039AC335D79176E23B4E3D98F2845644A3E1FB7B840",
#ifdef __ENABLE_DIGICERT_64_BIT__
        "0000000036596BECD5F8ECF278D2BE7A08FA8CCC7B429FED0BCEF07A6D09AC15",
#else
        "36596BECD5F8ECF278D2BE7A08FA8CCC7B429FED0BCEF07A6D09AC15",
#endif
        "B24F114826EC6450E035A5F249AE5E837CAFE7ACFEC78F35",
        "44BCD3DC7C6683683C6DDB0139E2CD63DCED072BF2903B2B365BF7CBE4AAFD6062B423C4B9D928BC32BDA9135F160863F4EB9881DBB5C3C8"
        "167920C46175899A5AF9D31E3C755FBDA3435EDFD1A4D80A219D663E5B4226756BEA356419FA66BB684A5F13ABFC8E49ECA4C1F4E51CDC56",
        1
    },
    {
        "AD5FAF1662FFB610E47A3AD6AC510DCB838F31C3EE754F2149192E11",
        "040A4065BE26C0DCEEF7E45A6EFEB5377D97242E6A76003940223E9DECB0A111C6CC785039AC335D79176E23B4E3D98F2845644A3E1FB7B840",
#ifdef __ENABLE_DIGICERT_64_BIT__
        "000000003D2970E679616403238FB8AAE2B5285DF3D5E92094BC1355E5D119AD",
#else
        "3D2970E679616403238FB8AAE2B5285DF3D5E92094BC1355E5D119AD",
#endif
        "4DF0DBD4F1334E4C91186EAAE3942B72322615A51F174393",
        "6D21E9322AE9EFE23DF4A486F683EBE76C028F6298396D2070B2ED7F66257AD720C1A25FB090E6A37A2301196BE07F3477859B39C90E2DB0"
        "64C6125255CD95E8D864E1E0F16CC1D7FBCE6259B38E539C06C481802625C9CDEB315EF786376E11018F425FB6C3B2326DD8DA30AD10E7F5",
        1
    },
    {
        "AD5FAF1662FFB610E47A3AD6AC510DCB838F31C3EE754F2149192E11",
        "040A4065BE26C0DCEEF7E45A6EFEB5377D97242E6A76003940223E9DECB0A111C6CC785039AC335D79176E23B4E3D98F2845644A3E1FB7B840",
#ifdef __ENABLE_DIGICERT_64_BIT__
        "000000003D2970E679616403238FB8AAE2B5285DF3D5E92094BC1355E5D119AD",
#else
        "3D2970E679616403238FB8AAE2B5285DF3D5E92094BC1355E5D119AD",
#endif
        "4DF0DBD4F1334E4C91186EAAE3942B72322615A51F174389",
        "6D21E9322AE9EFE23DF4A486F683EBE76C028F6298396D2070B2ED7F66257AD720C1A25FB090E6A37A2301196BE07F3477859B39C90E2DB0"
        "0190C81883FBDC7B02E000B7C41E4AEDCFEE09DED55829EE1AC52661566234ABFA3DEB64688B549325CB14B04D64E243F29BC8496A7A17F8",
        1
    },
    {   /* zero plaintext */
        "AD5FAF1662FFB610E47A3AD6AC510DCB838F31C3EE754F2149192E11",
        "040A4065BE26C0DCEEF7E45A6EFEB5377D97242E6A76003940223E9DECB0A111C6CC785039AC335D79176E23B4E3D98F2845644A3E1FB7B840",
#ifdef __ENABLE_DIGICERT_64_BIT__
        "000000003D2970E679616403238FB8AAE2B5285DF3D5E92094BC1355E5D119AD",
#else
        "3D2970E679616403238FB8AAE2B5285DF3D5E92094BC1355E5D119AD",
#endif
        "000000000000000000000000000000000000000000000000",
        "6D21E9322AE9EFE23DF4A486F683EBE76C028F6298396D2070B2ED7F66257AD720C1A25FB090E6A37A2301196BE07F3477859B39C90E2DB0"
        "14970A4027851FC94C24F2BC4B1D3BD0C3228CAFB663132CFAC0CE880BDEF6D1618AB89686A9D12D3A5192A3DEA4133B6D81A727A365AED0",
        1
    },
    {   /* zero plaintext for multiple blocks */
        "AD5FAF1662FFB610E47A3AD6AC510DCB838F31C3EE754F2149192E11",
        "040A4065BE26C0DCEEF7E45A6EFEB5377D97242E6A76003940223E9DECB0A111C6CC785039AC335D79176E23B4E3D98F2845644A3E1FB7B840",
#ifdef __ENABLE_DIGICERT_64_BIT__
        "000000003D2970E679616403238FB8AAE2B5285DF3D5E92094BC1355E5D119AD"
        "000000000FADF40B3B70EF3FD9FB9A2B41F88D1B7CC97E03FEB88A5B6F701E77",
#else
        "3D2970E679616403238FB8AAE2B5285DF3D5E92094BC1355E5D119AD"
        "0FADF40B3B70EF3FD9FB9A2B41F88D1B7CC97E03FEB88A5B6F701E77",
#endif
        "000000000000000000000000000000000000000000000000"
        "000000000000000000000000000000000000000000000000",
        "6D21E9322AE9EFE23DF4A486F683EBE76C028F6298396D2070B2ED7F66257AD720C1A25FB090E6A37A2301196BE07F3477859B39C90E2DB0"
        "14970A4027851FC94C24F2BC4B1D3BD0C3228CAFB663132CFAC0CE880BDEF6D1618AB89686A9D12D3A5192A3DEA4133B6D81A727A365AED0"
        "00A0D8620FEE600486090182600462BF3825D1ED9B41BCE1428E718C405D32942814A747B1B961974438BC6AF9D8000A80CB52CF13CFFFCF"
        "89C8A07BCAE3A5901EFB556C61354A0675F5DB4184C128FAC8975FB9025967456C36A61F627D75B8B34134A761A57BAA67BA262312720564",
        2
    },
    {
        "AD5FAF1662FFB610E47A3AD6AC510DCB838F31C3EE754F2149192E11",
        "040A4065BE26C0DCEEF7E45A6EFEB5377D97242E6A76003940223E9DECB0A111C6CC785039AC335D79176E23B4E3D98F2845644A3E1FB7B840",
#ifdef __ENABLE_DIGICERT_64_BIT__
        "000000000FADF40B3B70EF3FD9FB9A2B41F88D1B7CC97E03FEB88A5B6F701E77"
        "000000008B4AFBEC34D9CAB6C93B4A686DE57B049776E33D0DA39D3078AF4E19",
#else
        "0FADF40B3B70EF3FD9FB9A2B41F88D1B7CC97E03FEB88A5B6F701E77"
        "8B4AFBEC34D9CAB6C93B4A686DE57B049776E33D0DA39D3078AF4E19",
#endif
        "FAEFBD67893CAD4720EF6CD5DAD3CDD2C5FEA55E865303A6"
        "C04865365C91E805CB7C057922AC8D26D443A3C20BD29D0B",
        "00A0D8620FEE600486090182600462BF3825D1ED9B41BCE1428E718C405D32942814A747B1B961974438BC6AF9D8000A80CB52CF13CFFFCF"
        "2C12B894B38A2C9370C2F922932BB6ED645ADF48B274889519C6110EF0BAC4C41F69697CB70DD4659E8FF8F54C257C2A7D7BA5C2ED082656"
        "2CF4224DCDFC98868960B131A5AEE26E73B89CF428B56FFDD2B8D746145AF087CAB636CEB1F40353029C2EEEDE586943539C8E81FA45FE59"
        "0BC69B8ACE1AB88A4C2BBE04A28CAD539CC1C67BB82FB1FF538561869AF67EA9B33B8258F6A9CE61D62A713E967E5B8F08E31515C3C9E48E",
        2
    },
    {
        "AD5FAF1662FFB610E47A3AD6AC510DCB838F31C3EE754F2149192E11",
        "040A4065BE26C0DCEEF7E45A6EFEB5377D97242E6A76003940223E9DECB0A111C6CC785039AC335D79176E23B4E3D98F2845644A3E1FB7B840",
#ifdef __ENABLE_DIGICERT_64_BIT__
        "0000000036596BECD5F8ECF278D2BE7A08FA8CCC7B429FED0BCEF07A6D09AC15"
        "000000003D2970E679616403238FB8AAE2B5285DF3D5E92094BC1355E5D119AD",
#else
        "36596BECD5F8ECF278D2BE7A08FA8CCC7B429FED0BCEF07A6D09AC15"
        "3D2970E679616403238FB8AAE2B5285DF3D5E92094BC1355E5D119AD",
#endif
        "B24F114826EC6450E035A5F249AE5E837CAFE7ACFEC78F35"
        "4DF0DBD4F1334E4C91186EAAE3942B72322615A51F174393",
        "44BCD3DC7C6683683C6DDB0139E2CD63DCED072BF2903B2B365BF7CBE4AAFD6062B423C4B9D928BC32BDA9135F160863F4EB9881DBB5C3C8"
        "167920C46175899A5AF9D31E3C755FBDA3435EDFD1A4D80A219D663E5B4226756BEA356419FA66BB684A5F13ABFC8E49ECA4C1F4E51CDC56"
        "6D21E9322AE9EFE23DF4A486F683EBE76C028F6298396D2070B2ED7F66257AD720C1A25FB090E6A37A2301196BE07F3477859B39C90E2DB0"
        "64C6125255CD95E8D864E1E0F16CC1D7FBCE6259B38E539C06C481802625C9CDEB315EF786376E11018F425FB6C3B2326DD8DA30AD10E7F5",
        2
    },
    {
        "AD5FAF1662FFB610E47A3AD6AC510DCB838F31C3EE754F2149192E11",
        "040A4065BE26C0DCEEF7E45A6EFEB5377D97242E6A76003940223E9DECB0A111C6CC785039AC335D79176E23B4E3D98F2845644A3E1FB7B840",
#ifdef __ENABLE_DIGICERT_64_BIT__
        "000000000FADF40B3B70EF3FD9FB9A2B41F88D1B7CC97E03FEB88A5B6F701E77"
        "000000008B4AFBEC34D9CAB6C93B4A686DE57B049776E33D0DA39D3078AF4E19"
        "0000000036596BECD5F8ECF278D2BE7A08FA8CCC7B429FED0BCEF07A6D09AC15"
        "000000003D2970E679616403238FB8AAE2B5285DF3D5E92094BC1355E5D119AD",
#else
        "0FADF40B3B70EF3FD9FB9A2B41F88D1B7CC97E03FEB88A5B6F701E77"
        "8B4AFBEC34D9CAB6C93B4A686DE57B049776E33D0DA39D3078AF4E19"
        "36596BECD5F8ECF278D2BE7A08FA8CCC7B429FED0BCEF07A6D09AC15"
        "3D2970E679616403238FB8AAE2B5285DF3D5E92094BC1355E5D119AD",
#endif
        "FAEFBD67893CAD4720EF6CD5DAD3CDD2C5FEA55E865303A6"
        "C04865365C91E805CB7C057922AC8D26D443A3C20BD29D0B"
        "B24F114826EC6450E035A5F249AE5E837CAFE7ACFEC78F35"
        "4DF0DBD4F1334E4C91186EAAE3942B72322615A51F174393",
        "00A0D8620FEE600486090182600462BF3825D1ED9B41BCE1428E718C405D32942814A747B1B961974438BC6AF9D8000A80CB52CF13CFFFCF"
        "2C12B894B38A2C9370C2F922932BB6ED645ADF48B274889519C6110EF0BAC4C41F69697CB70DD4659E8FF8F54C257C2A7D7BA5C2ED082656"
        "2CF4224DCDFC98868960B131A5AEE26E73B89CF428B56FFDD2B8D746145AF087CAB636CEB1F40353029C2EEEDE586943539C8E81FA45FE59"
        "0BC69B8ACE1AB88A4C2BBE04A28CAD539CC1C67BB82FB1FF538561869AF67EA9B33B8258F6A9CE61D62A713E967E5B8F08E31515C3C9E48E"
        "44BCD3DC7C6683683C6DDB0139E2CD63DCED072BF2903B2B365BF7CBE4AAFD6062B423C4B9D928BC32BDA9135F160863F4EB9881DBB5C3C8"
        "167920C46175899A5AF9D31E3C755FBDA3435EDFD1A4D80A219D663E5B4226756BEA356419FA66BB684A5F13ABFC8E49ECA4C1F4E51CDC56"
        "6D21E9322AE9EFE23DF4A486F683EBE76C028F6298396D2070B2ED7F66257AD720C1A25FB090E6A37A2301196BE07F3477859B39C90E2DB0"
        "64C6125255CD95E8D864E1E0F16CC1D7FBCE6259B38E539C06C481802625C9CDEB315EF786376E11018F425FB6C3B2326DD8DA30AD10E7F5",
        4
    }
};

/*
 typedef struct TestVectorPKCS
 {
 char *pPrivateKey;
 char *pPublicKey;
 char *pNonce;
 char *pPlainText;
 char *pCipherText;
 
 } TestVectorPKCS;
 
 Input vectors are generated randomly. The resulting pCipherText is
 computed with MAGMA.
 */
static TestVectorPKCS gTestVector_p224PKCS[] =
{
    {    /* 13 byte message (largest possible) */
        "E1B6745A4DB15A83852600D0B00E6ADE78DCF92418A75928A06EE01F",
        "04E20814B6740686C54C2A63DB525F24F4D0079BDDD3DB16983692EEA7127CDDE99611D69510895A13D9F6B7FC5F08FC2D3D4575FCCA65392C",
        "9A55FA344B364551"
#ifdef __ENABLE_DIGICERT_64_BIT__
        "00000000D18CDF18BDF98A1B4CE2CC40DE7CA65572886849B0A27A41415F8DED",
#else
        "D18CDF18BDF98A1B4CE2CC40DE7CA65572886849B0A27A41415F8DED",
#endif
        "645519A55FA344B3645519A55F",
        "82BBF86C8A2F79D28237DF6BC27F8742F8CC91B1E2408F1DA3B5DE5FCD2434DAA27D1CC09109A10E0E9BF9FDD80304BCA089729825002909"
        "9E3256B106367F775B0A7B3FBE91084FC4700D7D71332053F2CC3E444FF2890C6F5C162AA380FA0DD253118D7711FE2A829D4F4A6E8947D9"
    },
    {   /* 1 byte message (smallest possible) */
        "E1B6745A4DB15A83852600D0B00E6ADE78DCF92418A75928A06EE01F",
        "04E20814B6740686C54C2A63DB525F24F4D0079BDDD3DB16983692EEA7127CDDE99611D69510895A13D9F6B7FC5F08FC2D3D4575FCCA65392C",
        "19A55FA344B3645519A55FA344B3645519A55FA3"
#ifdef __ENABLE_DIGICERT_64_BIT__
        "00000000D18CDF18BDF98A1B4CE2CC40DE7CA65572886849B0A27A41415F8DED",
#else
        "D18CDF18BDF98A1B4CE2CC40DE7CA65572886849B0A27A41415F8DED",
#endif
        "00",
        "82BBF86C8A2F79D28237DF6BC27F8742F8CC91B1E2408F1DA3B5DE5FCD2434DAA27D1CC09109A10E0E9BF9FDD80304BCA089729825002909"
        "C5C8719DA4FD71D266E791160D6A12E5F299684909F651A305110CA2E0FF7EA17AAA7110AF5C49F2046A41265E8AC2FC77C6837A825347D2"
    }
};
