/*
 * sha1_test.c
 *
 * SHA1 Algorithm Test
 *
 * Copyright 2025 DigiCert Project Authors. All Rights Reserved.
 * 
 * DigiCert® TrustCore and TrustEdge are licensed under a dual-license model:
 * - **Open Source License**: GNU AGPL v3. See: https://github.com/digicert/trustcore-test/blob/main/LICENSE
 * - **Commercial License**: Available under DigiCert’s Master Services Agreement. See: https://github.com/digicert/trustcore-test/blob/main/LICENSE_COMMERCIAL.txt  
 *   or https://www.digicert.com/master-services-agreement/
 * 
 * *For commercial licensing, contact DigiCert at sales@digicert.com.*
 *
 */

#include "../sha1.c"

#if defined( __RTOS_LINUX__) || defined(__RTOS_CYGWIN__) || defined(__RTOS_IRIX__) || defined (__RTOS_SOLARIS__) || defined (__RTOS_OPENBSD__)
#include <stdio.h>
#include <sys/types.h>
#include <sys/times.h>
#include <unistd.h>
#include <signal.h>
#endif

#include "../../../unit_tests/unittest.h"

typedef struct ShaTest 
{
    ubyte4 lenMsg;
    char* msg;
    char* digest;
} ShaTest;

static ShaTest gAllTests[] = 
{
{ 0,  "\x000",
 "\x0da\x039\x0a3\x0ee\x05e\x06b\x04b\x00d\x032\x055\x0bf\x0ef\x095\x060\x018\x090\x0af\x0d8\x007\x009" },
{ 8,  "\x0a8",
 "\x099\x0f2\x0aa\x095\x0e3\x06f\x095\x0c2\x0ac\x0b0\x0ea\x0f2\x039\x098\x0f0\x030\x063\x08f\x03f\x015" },
{ 16,  "\x030\x000",
 "\x0f9\x044\x0dc\x0d6\x035\x0f9\x080\x01f\x07a\x0c9\x00a\x040\x07f\x0bc\x047\x099\x064\x0de\x0c0\x024" },
{ 24,  "\x042\x074\x09e",
 "\x0a4\x044\x031\x09e\x09b\x06c\x0c1\x0e8\x046\x04c\x051\x01e\x0c0\x096\x09c\x037\x0d6\x0bb\x026\x019" },
{ 32,  "\x09f\x0c3\x0fe\x008",
 "\x016\x0a0\x0ff\x084\x0fc\x0c1\x056\x0fd\x05d\x03c\x0a3\x0a7\x044\x0f2\x00a\x023\x02d\x017\x022\x053" },
{ 40,  "\x0b5\x0c1\x0c6\x0f1\x0af",
 "\x0fe\x0c9\x0de\x0eb\x0fc\x0de\x0da\x0f6\x06d\x0da\x052\x05e\x01b\x0e4\x035\x097\x0a7\x03a\x01f\x093" },
{ 48,  "\x0e4\x075\x071\x0e5\x002\x02e",
 "\x08c\x0e0\x051\x018\x01f\x00e\x0d5\x0e9\x0d0\x0c4\x098\x0f6\x0bc\x04c\x0af\x044\x08d\x020\x0de\x0b5" },
{ 56,  "\x03e\x01b\x028\x083\x09f\x0b7\x058",
 "\x067\x0da\x053\x083\x07d\x089\x0e0\x03b\x0f6\x052\x0ef\x009\x0c3\x069\x0a3\x041\x059\x037\x0cf\x0d3" },
{ 64,  "\x0a8\x013\x050\x0cb\x0b2\x024\x0cb\x090",
 "\x030\x05e\x04f\x0f9\x088\x08a\x0d8\x055\x0a7\x085\x073\x0cd\x0df\x04c\x056\x040\x0cc\x0e7\x0e9\x046" },
{ 72,  "\x0c2\x043\x0d1\x067\x092\x03d\x0ec\x03c\x0e1",
 "\x059\x002\x0b7\x07b\x032\x065\x0f0\x023\x0f9\x0bb\x0c3\x096\x0ba\x01a\x093\x0fa\x035\x009\x0bd\x0e7" },
{ 80,  "\x050\x0ac\x018\x0c5\x09d\x06a\x037\x0a2\x09b\x0f4",
 "\x0fc\x0ad\x0e5\x0f5\x0d1\x056\x0bf\x06f\x09a\x0f9\x07b\x0df\x0a9\x0c1\x09b\x0cc\x0fb\x04f\x0f6\x0ab" },
{ 88,  "\x098\x0e2\x0b6\x011\x0ad\x03b\x01c\x0cc\x0f6\x034\x0f6",
 "\x01d\x020\x0fb\x0e0\x005\x033\x0c1\x00e\x03c\x0bd\x06b\x027\x008\x08a\x05d\x0e0\x0c6\x032\x0c4\x0b5" },
{ 96,  "\x073\x0fe\x09a\x0fb\x068\x0e1\x0e8\x071\x02e\x05d\x04e\x0ec",
 "\x07e\x01b\x07e\x00f\x07a\x08f\x034\x055\x0a9\x0c0\x03e\x095\x080\x0fd\x063\x0ae\x020\x05a\x02d\x093" },
{ 104,  "\x09e\x070\x01e\x0d7\x0d4\x012\x0a9\x022\x06a\x02a\x013\x00e\x066",
 "\x070\x06f\x006\x077\x014\x063\x007\x0b2\x00b\x0b0\x0e8\x0d6\x031\x01e\x032\x099\x066\x088\x04d\x013" },
{ 112,  "\x06d\x03e\x0e9\x004\x013\x0b0\x0a7\x0cb\x0f6\x09e\x05e\x061\x044\x0ca",
 "\x0a7\x024\x01a\x070\x03a\x0af\x00d\x053\x0fe\x014\x02f\x086\x0bf\x02e\x084\x092\x051\x0fa\x08d\x0ff" },
{ 120,  "\x0fa\x0e2\x04d\x056\x051\x04e\x0fc\x0b5\x030\x0fd\x048\x002\x0f5\x0e7\x01f",
 "\x040\x00f\x053\x054\x069\x016\x0d3\x03a\x0d0\x01a\x05e\x06d\x0f6\x068\x022\x0df\x0bd\x0c4\x0e9\x0e6" },
{ 128,  "\x0c5\x0a2\x02d\x0d6\x0ed\x0a3\x0fe\x02b\x0dc\x04d\x0db\x03c\x0e6\x0b3\x05f\x0d1",
 "\x0fa\x0c8\x0ab\x093\x0c1\x0ae\x06c\x016\x0f0\x031\x018\x072\x0b9\x084\x0f7\x029\x0dc\x092\x08c\x0cd" },
{ 136,  "\x0d9\x08c\x0de\x0d2\x0ad\x0ab\x0f0\x08f\x0da\x035\x064\x045\x0c7\x081\x080\x02d\x095",
 "\x0fb\x0a6\x0d7\x050\x0c1\x08d\x0a5\x08f\x06e\x02a\x0ab\x010\x011\x02b\x09a\x05e\x0f3\x030\x01b\x03b" },
{ 144,  "\x0bc\x0c6\x0d7\x008\x07a\x084\x0f0\x001\x003\x0cc\x0b3\x02e\x05f\x054\x087\x0a7\x051\x0a2",
 "\x029\x0d2\x07c\x02d\x044\x0c2\x005\x0c8\x010\x07f\x003\x051\x0b0\x057\x053\x0ac\x070\x082\x026\x0b6" },
{ 152,  "\x036\x0ec\x0ac\x0b1\x005\x054\x034\x019\x00d\x0bb\x0c5\x056\x0c4\x08b\x0af\x0cb\x00f\x0eb\x00d",
 "\x0b9\x071\x0bf\x0c1\x0eb\x0d6\x0f3\x059\x0e8\x0d7\x04c\x0b7\x0ec\x0fe\x07f\x089\x08d\x00b\x0a8\x045" },
{ 160,  "\x05f\x0f9\x0ed\x0b6\x09e\x08f\x06b\x0bd\x049\x08e\x0b4\x053\x075\x080\x0b7\x0fb\x0a7\x0ad\x031\x0d0",
 "\x096\x0d0\x08c\x043\x000\x094\x0b9\x0fc\x0c1\x064\x0ad\x02f\x0b6\x0f7\x02d\x00a\x024\x026\x08f\x068" },
{ 168,  "\x0c9\x05b\x044\x01d\x082\x070\x082\x02a\x046\x0a7\x098\x0fa\x0e5\x0de\x0fc\x0f7\x0b2\x06a\x0ba\x0ce\x036",
 "\x0a2\x087\x0ea\x075\x02a\x059\x03d\x052\x009\x0e2\x087\x088\x01a\x009\x0c4\x09f\x0a3\x0f0\x0be\x0b1" },
{ 176,  "\x083\x010\x04c\x01d\x08a\x055\x0b2\x08f\x090\x06f\x01b\x072\x0cb\x053\x0f6\x08c\x0bb\x009\x07b\x044\x0f8\x060",
 "\x0a0\x06c\x071\x037\x079\x0cb\x0d8\x085\x019\x0ed\x04a\x058\x05a\x0c0\x0cb\x08a\x05e\x09d\x061\x02b" },
{ 184,  "\x075\x051\x075\x052\x08d\x055\x0c3\x09c\x056\x049\x03d\x069\x07b\x079\x00f\x009\x09a\x05c\x0e7\x041\x0f7\x075\x04b",
 "\x0bf\x0f7\x0d5\x02c\x013\x0a3\x068\x081\x032\x0a1\x0d4\x007\x0b1\x0ab\x040\x0f5\x0b5\x0ac\x0e2\x098" },
{ 192,  "\x008\x08f\x0c3\x081\x028\x0bb\x0db\x09f\x0d7\x0d6\x052\x028\x0b3\x018\x04b\x03f\x0aa\x0c6\x0c8\x071\x05f\x007\x027\x02f",
 "\x0c7\x056\x06b\x091\x0d7\x0b6\x0f5\x06b\x0df\x0ca\x0a9\x078\x01a\x07b\x068\x041\x0aa\x0cb\x017\x0e9" },
{ 200,  "\x0a4\x0a5\x086\x0eb\x092\x045\x0a6\x0c8\x07e\x03a\x0df\x010\x009\x0ac\x08a\x049\x0f4\x06c\x007\x0e1\x041\x085\x001\x068\x095",
 "\x0ff\x0a3\x00c\x00b\x05c\x055\x00e\x0a4\x0b1\x0e3\x04f\x08a\x060\x0ec\x092\x095\x0a1\x0e0\x06a\x0c1" },
{ 208,  "\x08e\x07c\x055\x052\x070\x0c0\x006\x009\x02c\x02a\x031\x089\x0e2\x0a5\x026\x0b8\x073\x0e2\x0e2\x069\x0f0\x0fb\x028\x024\x052\x056",
 "\x029\x0e6\x06e\x0d2\x03e\x091\x043\x051\x0e8\x072\x0aa\x076\x01d\x0f6\x0e4\x0f1\x0a0\x07f\x04b\x081" },
{ 216,  "\x0a5\x0f3\x0bf\x0a6\x0bb\x00b\x0a3\x0b5\x09f\x06b\x09c\x0bd\x0ef\x08a\x055\x08e\x0c5\x065\x0e8\x0aa\x031\x021\x0f4\x005\x0e7\x0f2\x0f0",
 "\x0b2\x08c\x0f5\x0e5\x0b8\x006\x0a0\x014\x091\x0d4\x01f\x069\x0bd\x092\x048\x076\x05c\x05d\x0c2\x092" },
{ 224,  "\x058\x090\x054\x0f0\x0d2\x0bd\x03c\x02c\x085\x0b4\x066\x0bf\x0d8\x0ce\x018\x0e6\x0ec\x03e\x00b\x087\x0d9\x044\x0cd\x009\x03b\x0a3\x064\x069",
 "\x060\x022\x04f\x0b7\x02c\x046\x006\x096\x052\x0cd\x078\x0bc\x0d0\x080\x029\x0ef\x064\x0da\x062\x0f3" },
{ 232,  "\x0a0\x0ab\x0b1\x020\x083\x0b5\x0bb\x0c7\x081\x028\x060\x01b\x0f1\x0cb\x0db\x0c0\x0fd\x0f4\x0b8\x062\x0b2\x04d\x089\x099\x053\x0d8\x0da\x00f\x0f3",
 "\x0b7\x02c\x04a\x086\x0f7\x026\x008\x0f2\x04c\x005\x0f3\x0b9\x008\x08e\x0f9\x02f\x0ba\x043\x01d\x0f7" },
{ 240,  "\x082\x014\x03f\x04c\x0ea\x06f\x0ad\x0bf\x099\x08e\x012\x08a\x088\x011\x0dc\x075\x030\x01c\x0f1\x0db\x04f\x007\x095\x001\x0ea\x056\x08d\x0a6\x08e\x0eb",
 "\x073\x077\x09a\x0d5\x0d6\x0b7\x01b\x09b\x083\x028\x0ef\x072\x020\x0ff\x012\x0eb\x016\x070\x076\x0ac" },
{ 248,  "\x09f\x012\x031\x0dd\x06d\x0f1\x0ff\x07b\x0c0\x0b0\x0d4\x0f9\x089\x0d0\x048\x067\x026\x083\x0ce\x035\x0d9\x056\x0d2\x0f5\x079\x013\x004\x062\x067\x0e6\x0f3",
 "\x0a0\x096\x071\x0d4\x045\x02d\x07c\x0f5\x000\x015\x0c9\x014\x0a1\x0e3\x019\x073\x0d2\x00c\x0c1\x0a0" },
{ 256,  "\x004\x01c\x051\x02b\x05e\x0ed\x079\x01f\x080\x0d3\x028\x02f\x03a\x028\x0df\x026\x03b\x0b1\x0df\x095\x0e1\x023\x09a\x076\x050\x0e5\x067\x00f\x0c2\x018\x079\x019",
 "\x0e8\x08c\x0dc\x0d2\x033\x0d9\x091\x084\x0a6\x0fd\x026\x00b\x08f\x0ca\x01b\x07f\x076\x087\x0ae\x0e0" },
{ 264,  "\x017\x0e8\x01f\x06a\x0e8\x0c2\x0e5\x057\x09d\x069\x0da\x0fa\x06e\x007\x00e\x071\x011\x046\x015\x052\x0d3\x014\x0b6\x091\x0e7\x0a3\x0e7\x0a4\x0fe\x0b3\x0fa\x0e4\x018",
 "\x001\x00d\x0ef\x022\x085\x00d\x0eb\x011\x068\x0d5\x025\x0e8\x0c8\x04c\x028\x011\x06c\x0b8\x0a2\x069" },
{ 272,  "\x0d1\x059\x076\x0b2\x03a\x01d\x071\x02a\x0d2\x08f\x0ad\x004\x0d8\x005\x0f5\x072\x002\x06b\x054\x0dd\x064\x096\x01f\x0da\x094\x0d5\x035\x05a\x00c\x0c9\x086\x020\x0cf\x077",
 "\x0ae\x0aa\x040\x0ba\x017\x017\x0ed\x054\x039\x0b1\x0e6\x0ea\x090\x01b\x029\x04b\x0a5\x000\x0f9\x0ad" },
{ 280,  "\x009\x0fc\x0e4\x0d4\x034\x0f6\x0bd\x032\x0a4\x04e\x004\x0b8\x048\x0ff\x050\x0ec\x09f\x064\x02a\x08a\x085\x0b3\x07a\x026\x04d\x0c7\x03f\x013\x00f\x022\x083\x084\x043\x032\x08f",
 "\x0c6\x043\x037\x091\x023\x087\x095\x0e3\x04f\x008\x00a\x05f\x01f\x017\x023\x0f0\x065\x046\x03c\x0a0" },
{ 288,  "\x0f1\x07a\x0f2\x07d\x077\x06e\x0c8\x02a\x025\x07d\x08d\x046\x0d2\x0b4\x06b\x063\x094\x062\x0c5\x069\x084\x0cc\x01b\x0e9\x0c1\x022\x02e\x0ad\x0b8\x0b2\x065\x094\x0a2\x05c\x070\x09d",
 "\x0e2\x01e\x022\x0b8\x09c\x01b\x0b9\x044\x0a3\x029\x032\x0e6\x0b2\x0a2\x0f2\x00d\x049\x019\x082\x0c3" },
{ 296,  "\x0b1\x03c\x0e6\x035\x0d6\x0f8\x075\x081\x043\x0ff\x0b1\x014\x0f2\x0f6\x001\x0cb\x020\x0b6\x027\x069\x051\x041\x06a\x02f\x094\x0fb\x0f4\x0ad\x008\x017\x079\x0d7\x09f\x04f\x019\x05b\x022",
 "\x057\x053\x023\x0a9\x066\x01f\x05d\x028\x038\x079\x064\x0d2\x0ba\x06a\x0b9\x02c\x017\x0d0\x05a\x08a" },
{ 304,  "\x054\x098\x079\x03f\x060\x091\x06f\x0f1\x0c9\x018\x0dd\x0e5\x072\x0cd\x0ea\x076\x0da\x086\x029\x0ba\x04e\x0ad\x06d\x006\x05d\x0e3\x0df\x0b4\x08d\x0e9\x04d\x023\x04c\x0c1\x0c5\x000\x029\x010",
 "\x0fe\x0b4\x044\x094\x0af\x072\x0f2\x045\x0bf\x0e6\x08e\x086\x0c4\x0d7\x098\x06d\x057\x0c1\x01d\x0b7" },
{ 312,  "\x049\x08a\x01e\x00b\x039\x0fa\x049\x058\x02a\x0e6\x088\x0cd\x071\x05c\x086\x0fb\x0af\x08a\x081\x0b8\x0b1\x01b\x04d\x015\x094\x0c4\x09c\x090\x02d\x019\x07c\x08b\x0a8\x0a6\x021\x0fd\x06e\x03b\x0e5",
 "\x0cf\x0f2\x029\x00b\x036\x048\x0ba\x028\x031\x0b9\x08d\x0de\x043\x06a\x072\x0f9\x0eb\x0f5\x01e\x0ee" },
{ 320,  "\x03a\x036\x0ae\x071\x052\x01f\x09a\x0f6\x028\x0b3\x0e3\x04d\x0cb\x00d\x045\x013\x0f8\x04c\x078\x0ee\x049\x0f1\x004\x016\x0a9\x088\x057\x015\x00b\x08b\x015\x0cb\x05c\x083\x0af\x0b4\x0b5\x070\x037\x06e",
 "\x09b\x04e\x0fe\x09d\x027\x0b9\x065\x090\x05b\x00c\x03d\x0ab\x067\x0b8\x0d7\x0c9\x0eb\x0ac\x0d5\x06c" },
{ 328,  "\x0dc\x0c7\x06b\x040\x0ae\x00e\x0a3\x0ba\x025\x03e\x092\x0ac\x050\x0fc\x0de\x079\x016\x062\x0c5\x0b6\x0c9\x048\x053\x08c\x0ff\x0c2\x0d9\x05e\x09d\x0e9\x09c\x0ac\x034\x0df\x0ca\x038\x091\x00d\x0b2\x067\x08f",
 "\x0af\x0ed\x0b0\x0ff\x015\x062\x005\x0bc\x0d8\x031\x0cb\x0db\x0da\x043\x0db\x08b\x005\x088\x0c1\x013" },
{ 336,  "\x05b\x05e\x0c6\x0ec\x04f\x0d3\x0ad\x09c\x049\x006\x0f6\x05c\x074\x07f\x0d4\x023\x03c\x011\x0a1\x073\x06b\x06b\x022\x08b\x092\x0e9\x00c\x0dd\x0ab\x0b0\x0c7\x0c2\x0fc\x0f9\x071\x06d\x03f\x0ad\x026\x01d\x0ff\x033",
 "\x08d\x0eb\x01e\x085\x08f\x088\x029\x03a\x05e\x05e\x04d\x052\x01a\x034\x0b2\x0a4\x0ef\x0a7\x00f\x0c4" },
{ 344,  "\x0df\x048\x0a3\x07b\x029\x0b1\x0d6\x0de\x04e\x094\x071\x07d\x060\x0cd\x0b4\x029\x03f\x0cf\x017\x00b\x0ba\x038\x08b\x0dd\x0f7\x0a9\x003\x05a\x015\x0d4\x033\x0f2\x00f\x0d6\x097\x0c3\x0e4\x0c8\x0b8\x0c5\x0f5\x090\x0ab",
 "\x095\x0cb\x0da\x0c0\x0f7\x04a\x0fa\x069\x0ce\x0bd\x00e\x05c\x07d\x0ef\x0bc\x06f\x0af\x00c\x0be\x0af" },
{ 352,  "\x01f\x017\x09b\x03b\x082\x025\x00a\x065\x0e1\x0b0\x0ae\x0e9\x049\x0e2\x018\x0e2\x0f4\x05c\x07a\x08d\x0bf\x0d6\x0ba\x008\x0de\x005\x0c5\x05a\x0cf\x0c2\x026\x0b4\x08c\x068\x0d7\x0f7\x005\x07e\x056\x075\x0cd\x096\x0fc\x0fc",
 "\x0f0\x030\x07b\x0cb\x092\x084\x02e\x05a\x0e0\x0cd\x04f\x04f\x014\x0f3\x0df\x07f\x087\x07f\x0be\x0f2" },
{ 360,  "\x0ee\x03d\x072\x0da\x03a\x044\x0d9\x071\x057\x089\x072\x0a8\x0e6\x078\x00c\x0e6\x049\x041\x026\x07e\x00f\x07d\x001\x079\x0b2\x014\x0fa\x097\x085\x05e\x017\x090\x0e8\x088\x0e0\x09f\x0be\x03a\x070\x041\x021\x076\x0cb\x03b\x054",
 "\x07b\x013\x0bb\x00d\x0bf\x014\x096\x04b\x0d6\x03b\x013\x03a\x0c8\x05e\x022\x010\x005\x042\x0ef\x055" },
{ 368,  "\x0d4\x0d4\x0c7\x084\x03d\x031\x02b\x030\x0f6\x010\x0b3\x068\x022\x054\x0c8\x0be\x096\x0d5\x0f6\x068\x045\x003\x0f8\x0fb\x0fb\x0cd\x015\x077\x04f\x0c1\x0b0\x084\x0d3\x074\x01a\x0fb\x08d\x024\x0aa\x0a8\x0ab\x09c\x010\x04f\x072\x058",
 "\x0c3\x014\x0d2\x0b6\x0cf\x043\x09b\x0e6\x078\x0d2\x0a7\x04e\x089\x00d\x096\x0cf\x0ac\x01c\x002\x0ed" },
{ 376,  "\x032\x0c0\x094\x094\x04f\x059\x036\x0a1\x090\x0a0\x087\x07f\x0b9\x017\x08a\x07b\x0f6\x00c\x0ea\x0e3\x06f\x0d5\x030\x067\x01c\x05b\x038\x0c5\x0db\x0d5\x0e6\x0a6\x0c0\x0d6\x015\x0c2\x0ac\x08a\x0d0\x04b\x021\x03c\x0c5\x089\x054\x01c\x0f6",
 "\x04d\x00b\x0e3\x061\x0e4\x010\x0b4\x07a\x09d\x067\x0d8\x0ce\x00b\x0b6\x0a8\x0e0\x01c\x053\x0c0\x078" },
{ 384,  "\x0e5\x0d3\x018\x00c\x014\x0bf\x027\x0a5\x040\x09f\x0a1\x02b\x010\x04a\x08f\x0d7\x0e9\x063\x096\x009\x0bf\x0de\x06e\x0e8\x02b\x0bf\x096\x048\x0be\x025\x046\x0d2\x096\x088\x0a6\x05e\x02e\x03f\x03d\x0a4\x07a\x045\x0ac\x014\x034\x03c\x09c\x002",
 "\x0e5\x035\x034\x031\x0ff\x0ae\x009\x07f\x067\x05c\x0bf\x049\x088\x069\x0f6\x0fb\x0b6\x0e1\x0c9\x0f2" },
{ 392,  "\x0e7\x0b6\x0e4\x0b6\x09f\x072\x043\x027\x0e4\x01e\x011\x088\x0a3\x07f\x04f\x0e3\x08b\x01d\x0ba\x019\x0cb\x0f5\x0a7\x031\x01d\x06e\x032\x0f1\x003\x08e\x097\x0ab\x050\x06e\x0e0\x05a\x0eb\x0eb\x0c1\x0ee\x0d0\x09f\x0c0\x0e3\x057\x010\x098\x018\x0b9",
 "\x0b8\x072\x00a\x070\x068\x0a0\x085\x0c0\x018\x0ab\x018\x096\x01d\x0e2\x076\x05a\x0a6\x0cd\x09a\x0c4" },
{ 400,  "\x0bc\x088\x00c\x0b8\x03b\x08a\x0c6\x08e\x0f2\x0fe\x0dc\x02d\x0a9\x05e\x076\x077\x0ce\x02a\x0a1\x08b\x00e\x02d\x08b\x032\x027\x001\x0f6\x07a\x0f7\x0d5\x0e7\x0a0\x0d9\x06e\x09e\x033\x032\x06c\x0cb\x077\x047\x0cf\x0ff\x008\x052\x0b9\x061\x0bf\x0d4\x075",
 "\x0b0\x073\x021\x081\x056\x085\x043\x0ba\x085\x0f2\x0b6\x0da\x060\x02b\x04b\x006\x05d\x099\x031\x0aa" },
{ 408,  "\x023\x05e\x0a9\x0c2\x0ba\x07a\x0f2\x054\x000\x0f2\x0e9\x08a\x047\x0a2\x091\x0b0\x0bc\x0cd\x0aa\x0d6\x03f\x0aa\x024\x075\x072\x01f\x0da\x055\x010\x0cc\x07d\x0ad\x081\x04b\x0ce\x08d\x0ab\x0b6\x011\x079\x00a\x06a\x0be\x056\x003\x00b\x079\x08b\x075\x0c9\x044",
 "\x09c\x022\x067\x04c\x0f3\x022\x02c\x03b\x0a9\x021\x067\x026\x094\x0aa\x0fe\x0e4\x0ce\x067\x0b9\x06b" },
{ 416,  "\x007\x0e3\x0e2\x09f\x0ed\x063\x010\x04b\x084\x010\x0f3\x023\x0b9\x075\x0fd\x09f\x0ba\x053\x0f6\x036\x0af\x08c\x04e\x068\x0a5\x03f\x0b2\x002\x0ca\x035\x0dd\x09e\x0e0\x07c\x0b1\x069\x0ec\x051\x086\x029\x02e\x044\x0c2\x07e\x056\x096\x0a9\x067\x0f5\x0e6\x077\x009",
 "\x0d1\x028\x033\x05f\x04c\x0ec\x0ca\x090\x066\x0cd\x0ae\x008\x095\x08c\x0e6\x056\x0ff\x00b\x04c\x0fc" },
{ 424,  "\x065\x0d2\x0a1\x0dd\x060\x0a5\x017\x0eb\x027\x0bf\x0bf\x053\x00c\x0f6\x0a5\x045\x08f\x09d\x05f\x047\x030\x005\x08b\x0d9\x081\x043\x079\x054\x07f\x034\x024\x018\x022\x0bf\x067\x0e6\x033\x05a\x06d\x08b\x05e\x0d0\x06a\x0bf\x088\x041\x088\x04c\x063\x06a\x025\x073\x03f",
 "\x00b\x067\x0c5\x07a\x0c5\x078\x0de\x088\x0a2\x0ae\x005\x05c\x0ae\x0ae\x0c8\x0bb\x09b\x000\x085\x0a0" },
{ 432,  "\x0dc\x0c8\x06b\x03b\x0d4\x061\x061\x05b\x0ab\x073\x09d\x08d\x0aa\x0fa\x0c2\x031\x0c0\x0f4\x062\x0e8\x019\x0ad\x029\x0f9\x0f1\x040\x058\x0f3\x0ab\x05b\x075\x094\x01d\x042\x041\x0ea\x02f\x017\x0eb\x0b8\x0a4\x058\x083\x01b\x037\x0a9\x0b1\x06d\x0ea\x0d4\x0a7\x06a\x09b\x00e",
 "\x0c7\x066\x0f9\x012\x0a8\x09d\x04c\x0cd\x0a8\x08e\x00c\x0ce\x06a\x071\x03e\x0f5\x0f1\x078\x0b5\x096" },
{ 440,  "\x046\x027\x0d5\x04f\x005\x068\x0dc\x012\x06b\x062\x0a8\x0c3\x05f\x0b4\x06a\x09a\x0c5\x002\x044\x000\x0f2\x099\x05e\x051\x063\x056\x036\x0e1\x0af\x0c4\x037\x03d\x0bb\x084\x08e\x0b3\x02d\x0f2\x039\x014\x023\x005\x060\x0b8\x024\x077\x0e9\x0c3\x057\x026\x047\x0a7\x0f2\x0bb\x092",
 "\x09a\x0a3\x092\x05a\x09d\x0cb\x017\x07b\x015\x0cc\x0ff\x09b\x078\x0e7\x00c\x0f3\x044\x085\x087\x079" },
{ 448,  "\x0ba\x053\x01a\x0ff\x0d4\x038\x011\x068\x0ef\x024\x0d8\x0b2\x075\x0a8\x04d\x092\x054\x0c7\x0f5\x0cc\x055\x0fd\x0ed\x053\x0aa\x080\x024\x0b2\x0c5\x0c5\x0c8\x0aa\x071\x046\x0fe\x01d\x01b\x083\x0d6\x02b\x070\x046\x07e\x09a\x02e\x02c\x0b6\x07b\x033\x061\x083\x00a\x0db\x0ab\x028\x0d7",
 "\x048\x011\x0fa\x030\x004\x02f\x0c0\x076\x0ac\x0f3\x07c\x08e\x022\x074\x0d0\x025\x030\x07e\x059\x043" },
{ 456,  "\x087\x064\x0dc\x0bc\x0f8\x09d\x0cf\x042\x082\x0eb\x064\x04e\x03d\x056\x08b\x0dc\x0cb\x04b\x013\x050\x08b\x0fa\x07b\x0fe\x00f\x0fc\x005\x0ef\x0d1\x039\x00b\x0e2\x021\x009\x096\x092\x062\x099\x02d\x037\x076\x091\x0eb\x04f\x077\x0f3\x0d5\x09e\x0a8\x046\x06a\x074\x0ab\x0f5\x07b\x02e\x0f4",
 "\x067\x043\x001\x084\x050\x0c9\x073\x007\x061\x0ee\x02b\x013\x00d\x0f9\x0b9\x01c\x01e\x011\x081\x050" },
{ 464,  "\x049\x07d\x09d\x0f9\x0dd\x0b5\x054\x0f3\x0d1\x078\x070\x0b1\x0a3\x019\x086\x0c1\x0be\x027\x07b\x0c4\x04f\x0ef\x0f7\x013\x054\x042\x017\x0a9\x0f5\x079\x062\x03d\x018\x0b5\x0ff\x0ae\x030\x06c\x025\x0a4\x055\x021\x0d2\x075\x09a\x072\x0c0\x045\x09b\x058\x095\x072\x055\x0ab\x059\x02f\x03b\x0e4",
 "\x071\x0ad\x04a\x019\x0d3\x07d\x092\x0a5\x0e6\x0ef\x036\x094\x0dd\x0be\x0b5\x0aa\x061\x0ad\x0a6\x045" },
{ 472,  "\x072\x0c3\x0c2\x0e0\x065\x0ae\x0fa\x08d\x09f\x07a\x065\x022\x09e\x081\x081\x076\x0ee\x0f0\x05d\x0a8\x03f\x083\x051\x007\x0ba\x090\x0ec\x02e\x095\x047\x02e\x073\x0e5\x038\x0f7\x083\x0b4\x016\x0c0\x046\x054\x0ba\x089\x009\x0f2\x06a\x012\x0db\x06e\x05c\x04e\x037\x06b\x076\x015\x0e4\x0a2\x058\x019",
 "\x0a7\x0d9\x0dc\x068\x0da\x0ce\x0fb\x07d\x061\x016\x018\x060\x048\x0cb\x035\x05c\x0c5\x048\x0e1\x01d" },
{ 480,  "\x07c\x0c9\x089\x044\x054\x0d0\x005\x05a\x0b5\x006\x09a\x033\x098\x04e\x02f\x071\x02b\x0ef\x07e\x031\x024\x096\x00d\x033\x055\x09f\x05f\x03b\x081\x090\x06b\x0b6\x06f\x0e6\x04d\x0a1\x03c\x015\x03c\x0a7\x0f5\x0ca\x0bc\x089\x066\x073\x014\x0c3\x02c\x001\x003\x06d\x012\x0ec\x0af\x05f\x09a\x078\x0de\x098",
 "\x014\x02e\x042\x09f\x005\x022\x0ba\x05a\x0bf\x051\x031\x0fa\x081\x0df\x082\x0d3\x055\x0b9\x069\x009" },
{ 488,  "\x074\x0e8\x040\x04d\x05a\x045\x03c\x05f\x04d\x030\x06f\x02c\x0fa\x033\x08c\x0a6\x055\x001\x0c8\x040\x0dd\x0ab\x03f\x0b8\x021\x017\x093\x034\x083\x0af\x0d6\x091\x03c\x056\x0aa\x0f8\x0a0\x0a0\x0a6\x0b2\x0a3\x042\x0fc\x03d\x09d\x0c7\x059\x09f\x04a\x085\x00d\x0fa\x015\x0d0\x06c\x061\x096\x06d\x074\x0ea\x059",
 "\x0ef\x072\x0db\x070\x0dc\x0bc\x0ab\x099\x01e\x096\x037\x097\x06c\x06f\x0af\x000\x0d2\x02c\x0aa\x0e9" },
{ 496,  "\x046\x0fe\x05e\x0d3\x026\x0c8\x0fe\x037\x06f\x0cc\x092\x0dc\x09e\x027\x014\x0e2\x024\x00d\x032\x053\x0b1\x005\x0ad\x0fb\x0b2\x056\x0ff\x07a\x019\x0bc\x040\x097\x05c\x060\x04a\x0d7\x0c0\x007\x01c\x04f\x0d7\x08a\x07c\x0b6\x047\x086\x0e1\x0be\x0ce\x054\x08f\x0a4\x083\x03c\x004\x006\x05f\x0e5\x093\x0f6\x0fb\x010",
 "\x0f2\x020\x0a7\x045\x07f\x045\x088\x0d6\x039\x0dc\x021\x040\x07c\x094\x02e\x098\x043\x0f8\x0e2\x06b" },
{ 504,  "\x083\x06d\x0fa\x025\x024\x0d6\x021\x0cf\x007\x0c3\x0d2\x090\x088\x035\x0de\x085\x09e\x054\x09d\x035\x003\x004\x033\x0c7\x096\x0b8\x012\x072\x0fd\x08b\x0c0\x034\x08e\x08d\x0db\x0c7\x070\x05a\x05a\x0d1\x0fd\x0f2\x015\x05b\x06b\x0c4\x088\x084\x0ac\x00c\x0d3\x076\x092\x05f\x006\x09a\x037\x084\x09c\x008\x09c\x086\x045",
 "\x0dd\x0d2\x011\x07b\x06e\x030\x09c\x023\x03e\x0de\x085\x0f9\x062\x0a0\x0c2\x0fc\x021\x05e\x05c\x069" },
{ 512,  "\x07e\x03a\x04c\x032\x05c\x0b9\x0c5\x02b\x088\x038\x07f\x093\x0d0\x01a\x0e8\x06d\x042\x009\x08f\x05e\x0fa\x07f\x094\x057\x038\x08b\x05e\x074\x0b6\x0d2\x08b\x024\x038\x0d4\x02d\x08b\x064\x070\x033\x024\x0d4\x0aa\x025\x0ab\x06a\x0ad\x015\x03a\x0e3\x00c\x0d2\x0b2\x0af\x04d\x05e\x05c\x000\x0a8\x0a2\x0d0\x022\x00c\x061\x016",
 "\x0a3\x005\x044\x027\x0cd\x0b1\x03f\x016\x04a\x061\x00b\x034\x087\x002\x072\x04c\x080\x08a\x00d\x0cc" },

};


/*------------------------------------------------------------------*/

#if defined( __RTOS_LINUX__) || defined(__RTOS_CYGWIN__) || defined(__RTOS_IRIX__) || defined (__RTOS_SOLARIS__) || defined(__RTOS_OPENBSD__)

static volatile int mContinueTest;

#ifndef TEST_SECONDS
#define TEST_SECONDS (3)
#endif

#define START_ALARM(secs) { signal(SIGALRM, stop_test); \
                             mContinueTest = 1;          \
                             alarm(secs);                }

#define ALARM_OFF         (mContinueTest)

/*------------------------------------------------------------------*/
/* SIGALRM signal handler */
static void stop_test( int sig)
{
    sig; /* to get rid of unused warnings */
    mContinueTest = 0;
}


/*------------------------------------------------------------------*/

static void sha1_speed_test(MOC_HASH(hwAccelDescr hwAccelCtx) int dummy)
{
    ubyte* buffer = 0;
    int i;
    ubyte4 sizes[] = { 16, 64, 256, 1024, 8192 };
    ubyte digest[SHA1_RESULT_SIZE];

    buffer = (ubyte*) MALLOC(8192);
    if ( buffer)
    {
        for (i = 0; i < 8192; ++i)
        {
            buffer[i] = (ubyte) i;
        }

        for ( i = 0; i < COUNTOF(sizes); ++i)
        {
            struct tms tstart, tend;
            double diffTime, kbytes;
            ubyte4 counter;

            START_ALARM(TEST_SECONDS);
            times(&tstart);
            counter = 0;
            while( ALARM_OFF)
            {
                SHA1_completeDigest(MOC_HASH(hwAccelCtx) buffer, sizes[i], digest);
                counter++;
            }
            times(&tend);
            diffTime = tend.tms_utime-tstart.tms_utime;
            diffTime /= sysconf(_SC_CLK_TCK);
            kbytes = sizes[i] * (counter / 1024.0);
            printf("\tSHA1: %d SHA1 in %g seconds of CPU time\n", 
                   counter, diffTime);
            printf("SHA1: %g kbytes/second (CPU time)(%d bytes block) (1 kbyte = 1024 bytes)\n",
                   kbytes/diffTime, sizes[i]);
            
        }
        
        FREE(buffer);
    }    
}

#endif   /* defined( __RTOS_LINUX__) || defined(__RTOS_CYGWIN__) || defined(__RTOS_IRIX__) || defined( __RTOS_SOLARIS__) || defined(__RTOS_OPENBSD__) */





/*---------------------------------------------------------------------*/

int sha1_test_all()
{
    int i, j, retVal = 0;
    hwAccelDescr hwAccelCtx;

    if (OK > (MSTATUS)(retVal = HARDWARE_ACCEL_OPEN_CHANNEL(MOCANA_SSL, &hwAccelCtx)))
        return retVal;

    for (i = 0; i < COUNTOF(gAllTests); ++i)
    {
        SHA1_CTX ctx;
        ubyte result[SHA1_RESULT_SIZE];
        char* msg;
        sbyte4 resCmp;

        SHA1_initDigest(MOC_HASH(hwAccelCtx) &ctx);
        msg = gAllTests[i].msg;

        /* send the message byte by byte -- slower but exercise the algo */
        for (j = 0; j < gAllTests[i].lenMsg/8; j++)
        {
            SHA1_updateDigest(MOC_HASH(hwAccelCtx) &ctx, msg + j, 1);  
        }
        SHA1_finalDigest(MOC_HASH(hwAccelCtx) &ctx, result);

#if 0
        {
            int c;

            printf("    { 0x%02x, { ", i);
            for (c = 0; c < SHA1_RESULT_SIZE; c++)
                printf("0x%02x,", result[c]);
            printf("} },\n");
        }
#endif

        DIGI_MEMCMP( result, gAllTests[i].digest, SHA1_RESULT_SIZE, &resCmp);

        if (0 != resCmp)
            retVal++; 
    }


#if defined( __RTOS_LINUX__) || defined(__RTOS_CYGWIN__) || defined(__RTOS_IRIX__) || defined (__RTOS_SOLARIS__) || defined(__RTOS_OPENBSD__)
    sha1_speed_test(MOC_HASH(hwAccelCtx) 0);
#endif

    HARDWARE_ACCEL_CLOSE_CHANNEL(MOCANA_SSL, &hwAccelCtx);

    return retVal;
}
