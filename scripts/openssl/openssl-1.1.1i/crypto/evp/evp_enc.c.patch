10a11
> #include <limits.h>
357a359,371
> 
>             /*
>              * Once we've processed the first j bytes from in, the amount of
>              * data left that is a multiple of the block length is:
>              * (inl - j) & ~(bl - 1)
>              * We must ensure that this amount of data, plus the one block that
>              * we process from ctx->buf does not exceed INT_MAX
>              */
>             if (((inl - j) & ~(bl - 1)) > INT_MAX - bl) {
>                 EVPerr(EVP_F_EVP_ENCRYPTDECRYPTUPDATE,
>                        EVP_R_OUTPUT_WOULD_OVERFLOW);
>                 return 0;
>             }
504a519,531
>         /*
>          * final_used is only ever set if buf_len is 0. Therefore the maximum
>          * length output we will ever see from evp_EncryptDecryptUpdate is
>          * the maximum multiple of the block length that is <= inl, or just:
>          * inl & ~(b - 1)
>          * Since final_used has been set then the final output length is:
>          * (inl & ~(b - 1)) + b
>          * This must never exceed INT_MAX
>          */
>         if ((inl & ~(b - 1)) > INT_MAX - b) {
>             EVPerr(EVP_F_EVP_DECRYPTUPDATE, EVP_R_OUTPUT_WOULD_OVERFLOW);
>             return 0;
>         }
674a702,703
>         /* Mocana - Fix for memory Initialization */
>         if(out->cipher_data) memset(out->cipher_data, 0, in->cipher->ctx_size);
